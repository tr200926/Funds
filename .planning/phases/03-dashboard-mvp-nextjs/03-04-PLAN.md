---
phase: 03-dashboard-mvp-nextjs
plan: 04
type: execute
wave: 3
depends_on: ["03-01", "03-02", "03-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Dashboard loads and is fully functional end-to-end"
    - "All pages render correctly with real data"
    - "Auth flow works: login, session persistence, sign out"
    - "Real-time updates work on overview and pipeline pages"
    - "Dashboard is usable on mobile screen sizes"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete dashboard end-to-end: login flow, overview page with real-time, account detail with charts, pipeline health, responsive layout, and performance.

Purpose: Before marking Phase 3 complete, the user must verify that the dashboard works with real Supabase data, auth flow is functional, real-time updates are visible, and the UI is acceptable on both desktop and mobile.

Output: User confirmation that the dashboard MVP meets acceptance criteria.
</objective>

<execution_context>
@C:/Users/hossa/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/hossa/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-dashboard-mvp-nextjs/03-01-SUMMARY.md
@.planning/phases/03-dashboard-mvp-nextjs/03-02-SUMMARY.md
@.planning/phases/03-dashboard-mvp-nextjs/03-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Full dashboard end-to-end verification</name>
  <files>dashboard/src/app/(dashboard)/overview/page.tsx</files>
  <action>
This is a human verification checkpoint. The executor should ensure the dev server is running (`cd dashboard and npm run dev`) and present the verification steps below to the user. No code changes are needed.

What was built:
- Next.js 15 app with Supabase SSR auth (login, middleware, session refresh)
- Account overview page with sortable DataTable, platform/status/BM filters, and real-time updates
- Account detail page with Recharts spend trend and balance history charts, alert history
- Pipeline health page with run history, summary stats, and real-time updates
- Responsive layout with sidebar (desktop) and mobile navigation

How to verify:

**Prerequisites:**
1. Ensure `.env.local` is configured in `dashboard/` with `NEXT_PUBLIC_SUPABASE_URL` and `NEXT_PUBLIC_SUPABASE_ANON_KEY`
2. Ensure the Supabase Realtime migration has been applied: `npx supabase db push` or apply `supabase/migrations/20260212100000_enable_realtime.sql` manually
3. Start the dev server: `cd dashboard and npm run dev`

**Auth Flow (R4.6):**
1. Open http://localhost:3000 -- should redirect to /login
2. Attempt login with invalid credentials -- should show error message
3. Login with valid credentials -- should redirect to /overview
4. Verify sidebar shows "Targetspro" org name and your role badge
5. Click user menu (top right) -- should show role and Sign Out option
6. Click Sign Out -- should redirect to /login
7. Login again to continue testing

**Account Overview (R4.2, R4.4, R4.5):**
8. Navigate to /overview -- should see all ad accounts in a table
9. Verify columns: Account Name, Platform, Business Manager, Balance, Daily Spend, MTD Spend, Status, Days Left, Last Sync
10. Click "Balance" header -- should sort by balance (ascending/descending)
11. Use Platform filter -- should filter to only Facebook or TikTok
12. Use Status filter -- should filter to only active/paused/disabled
13. Use Business Manager filter -- should filter by selected BM
14. Click "Clear Filters" -- should reset all filters
15. Verify financial values show formatted currency (e.g., "EGP 1,234.56")
16. Verify "Days Left" shows colored badges for at-risk accounts

**Real-time Updates (R4.5):**
17. Keep /overview open in browser
18. In another tab or Supabase dashboard, update an ad_account's current_balance
19. Verify the overview table updates WITHOUT page refresh (within ~5 seconds)

**Account Detail (R4.3, R4.10):**
20. Click on an account name in the overview table -- should navigate to /accounts/{id}
21. Verify account header shows name, platform, status, balance, spend info
22. Verify spend trend chart renders (area chart with daily spend over time)
23. Verify balance history chart renders (line chart)
24. Verify alert history section shows alerts (or "No alerts" message)
25. Charts should be responsive -- resize browser window and verify they adapt

**Pipeline Health (R4.7):**
26. Navigate to /pipeline via sidebar
27. Verify summary stats: total runs, success rate, last successful run, failed accounts
28. Verify run history table shows pipeline name, status, timing, processed/failed counts
29. Verify status badges are color-coded (green=success, red=failed, blue=running, yellow=partial)
30. If any failed runs with error_log: click "View" -- should open dialog with error details

**Responsive Design (R4.8):**
31. Open browser DevTools, toggle device toolbar (mobile view)
32. Verify sidebar is hidden, hamburger menu appears in header
33. Click hamburger -- sidebar slides in as a Sheet overlay
34. Verify tables have horizontal scroll on narrow screens
35. Verify filter controls wrap to multiple lines
36. Verify charts resize appropriately

**Performance:**
37. Note initial page load time for /overview -- should be under 3 seconds
  </action>
  <verify>User types "approved" or describes issues found.</verify>
  <done>User has confirmed the dashboard MVP meets all acceptance criteria for Phase 3: auth works, data displays correctly, real-time updates function, charts render, pipeline health page works, responsive design is acceptable, and performance meets the under-3-second target.</done>
</task>

</tasks>

<verification>
All verification is performed by the user in the checkpoint task above.
</verification>

<success_criteria>
User has verified:
- Auth flow works (login, session, sign out)
- Overview page shows all accounts with correct data and formatting
- Filters work for platform, status, business manager
- Real-time updates appear within 5 seconds
- Account detail page shows charts and alert history
- Pipeline health page shows run history and stats
- Responsive design works on mobile viewports
- Dashboard loads in under 3 seconds
</success_criteria>

<output>
After completion, create `.planning/phases/03-dashboard-mvp-nextjs/03-04-SUMMARY.md`
</output>
